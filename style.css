/* Knight Runner — classic look with fail-safe checkerboard and no scrolling */
:root{
  --board: min(92vmin, 92svmin);
  --cell: calc(var(--board) / 8);
}

*{ box-sizing:border-box; }
html,body{ height:100dvh; margin:0; overflow:hidden; }

body{
  background: radial-gradient(120% 120% at 50% -20%, #1b2250 0%, #0e1430 60%, #0a0f24 100%);
  color:#fff; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  display:flex; flex-direction:column; align-items:center; gap:10px;
  padding: env(safe-area-inset-top) 8px env(safe-area-inset-bottom);
}

h1{ margin:6px 0 0; font-size:clamp(18px,3.8vw,28px); text-shadow:0 2px 6px #0006; }

/* HUD */
.hud{ display:flex; gap:10px; align-items:center; justify-content:center; flex-wrap:wrap; font-weight:600; text-shadow:0 1px 2px #0008; }
.pill{ padding:6px 10px; border-radius:999px; background:#222; border:1px solid #333; }
#status{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
.badge{ padding:4px 8px; border-radius:999px; border:1px solid #444; background:#1c1c1c; font-size:12px; opacity:.9; }
.badge.active{ border-color:#2ecc71; box-shadow:0 0 0 2px #2ecc7133 inset; }
#muteBtn{ padding:6px 10px; border-radius:999px; border:1px solid #444; background:#1c1c1c; color:#fff; cursor:pointer; }

/* Game frame */
#game{
  position:relative;
  width:var(--board); height:var(--board);
  border:4px solid #fff; border-radius:12px; overflow:hidden;
  box-shadow:0 12px 40px #0008, inset 0 0 0 1px #0006;
}

/* ✅ Fail-safe checkerboard drawn once behind everything */
#game::before{
  content:""; position:absolute; inset:0; z-index:0; pointer-events:none;
  /* chess colors */
  --light:#f0d9b5; --dark:#b58863;
  /* conic gradient checkerboard, tiles size = 2×cell */
  background:
    conic-gradient(from 0deg, var(--light) 0 25%, var(--dark) 0 50%, var(--light) 0 75%, var(--dark) 0)
    0 0 / calc(var(--cell)*2) calc(var(--cell)*2);
}

/* Shake */
#game.shake{ animation:shake .35s ease; }
@keyframes shake{0%,100%{transform:translate3d(0,0,0)}20%{transform:translate3d(-6px,0,0)}40%{transform:translate3d(6px,0,0)}60%{transform:translate3d(-4px,0,0)}80%{transform:translate3d(4px,0,0)}}

/* Squares — keep absolute positioning, but make them transparent so stripes can’t appear */
#game .square{
  position:absolute !important;
  width:var(--cell) !important;
  height:var(--cell) !important;
  background:transparent !important; /* ⬅ stripes killer */
}
#game .light{ background:transparent !important; }
#game .dark { background:transparent !important; }

/* Pieces */
.piece{ position:absolute; width:var(--cell); height:var(--cell); display:flex; align-items:center; justify-content:center; user-select:none; pointer-events:none; }
.knight{ z-index:110; color:#fff; font-size:calc(var(--cell)*0.70); text-shadow:0 2px 6px #0009; transition:left .18s cubic-bezier(.2,.7,.2,1), top .18s cubic-bezier(.2,.7,.2,1), filter .2s ease; }
.knight.danger{ filter:drop-shadow(0 0 10px #e74c3c) }
.enemy{ z-index:90; color:#000; font-size:calc(var(--cell)*0.66); filter:drop-shadow(0 2px 2px rgba(0,0,0,.6)); }

/* Move dots */
.dot{ position:absolute; width:var(--cell); height:var(--cell); display:flex; align-items:center; justify-content:center; z-index:120; cursor:pointer; }
.dot span{ width:calc(var(--cell)*0.24); height:calc(var(--cell)*0.24); border-radius:50%; background:#2ecc71; box-shadow:0 0 0 3px #2ecc7144, 0 2px 6px #0007; }
.dot:active span{ transform:scale(.92); }

/* Arrow guide */
#guideLayer{ position:absolute; inset:0; pointer-events:none; z-index:140; }
.ga-primary{ stroke:#2ecc71; stroke-width:8; fill:none; filter:drop-shadow(0 2px 4px rgba(0,0,0,.6)); }
.ga-hint{ stroke:#00d2ff; stroke-width:6; fill:none; stroke-dasharray:10 8; filter:drop-shadow(0 2px 4px rgba(0,0,0,.5)); }
.ga-invalid{ stroke:#e74c3c; opacity:.6; }
.ga-label{ font:600 14px/1 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; fill:#fff; paint-order:stroke; stroke:#000; stroke-width:3px; }

/* Power-ups */
.power{ position:absolute; z-index:80; width:var(--cell); height:var(--cell); display:flex; align-items:center; justify-content:center; pointer-events:none; }
.power .glyph{ font-size:calc(var(--cell)*0.4); filter:drop-shadow(0 2px 4px #0008) }
.power .ring{ position:absolute; width:calc(var(--cell)*0.36); height:calc(var(--cell)*0.36); border-radius:50%; box-shadow:0 0 0 3px #fff6 inset, 0 0 10px #fff6 }
.power.fade{ animation:fadeout .45s forwards; }
@keyframes fadeout{ to{ opacity:0; transform:scale(.9) } }

/* Game over */
#over{ position:absolute; inset:0; background:rgba(0,0,0,.55); display:none; align-items:center; justify-content:center; flex-direction:column; z-index:200; text-align:center; padding:20px; }
#over h2{ margin:0 0 8px; font-size:clamp(20px,5vw,36px); }
#over p{ margin:0 0 12px; opacity:.9; }
#restart{ padding:10px 14px; border-radius:10px; border:1px solid #fff4; background:#fff; color:#111; cursor:pointer; font-weight:700; }
#saveRow{ display:flex; gap:8px; align-items:center; justify-content:center; margin-top:8px; }
#playerName{ padding:8px 10px; border-radius:8px; border:1px solid #444; background:#222; color:#fff; min-width:160px; }
#saveBtn{ padding:8px 12px; border-radius:8px; border:1px solid #2ecc71; background:#2ecc71; color:#111; font-weight:700; cursor:pointer; }
#saveBtn[disabled]{ opacity:.6; cursor:not-allowed }

/* Leaderboard (unchanged) */
#leaderboard{ width:min(var(--board), 95vw); background:#1a1a1a; border:1px solid #2a2a2a; border-radius:12px; box-shadow:0 8px 24px #0007; overflow:hidden; margin:6px 0 10px; }
#leaderboard header{ display:flex; justify-content:space-between; align-items:center; padding:8px 10px; background:#222; border-bottom:1px solid #2f2f2f; }
#leaderboard h3{ margin:0; font-size:14px; letter-spacing:.3px; }
#lbStatus{ opacity:.8; font-size:12px; }
#leaderboard ol{ list-style:none; margin:0; padding:8px 10px; display:grid; grid-template-columns:1fr auto; row-gap:4px; max-height:24dvh; overflow:auto; }
#leaderboard li{ display:contents; }
#leaderboard .name{ overflow:hidden; text-overflow:ellipsis; white-space:nowrap; padding-right:8px; }
#leaderboard .score{ font-variant-numeric:tabular-nums; }

/* Error overlay (optional) */
#errorOverlay{ position:fixed; inset:0; background:#1b1b1bcc; color:#fff; z-index:9999; display:none; align-items:flex-start; justify-content:center; padding:16px; overflow:auto }
#errorOverlay pre{ max-width:900px; width:100%; background:#2a2a2a; border:1px solid #ff6b6b; border-radius:10px; padding:12px; white-space:pre-wrap; word-break:break-word }
