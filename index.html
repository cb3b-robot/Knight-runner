<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Knight Runner</title>
<style>
  body {
    margin: 0;
    font-family: 'Arial', sans-serif;
    background: #222;
    display: flex;
    flex-direction: column;
    align-items: center;
    color: #fff;
    overflow: hidden;
  }

  h1 {
    margin: 10px;
    font-size: 2em;
    text-shadow: 2px 2px 8px #000;
  }

  #game-container {
    position: relative;
    width: 600px;
    height: 600px;
    border: 4px solid #fff;
    border-radius: 10px;
    background-color: #fff;
    display: grid;
    grid-template-columns: repeat(8, 1fr);
    grid-template-rows: repeat(8, 1fr);
    overflow: hidden;
  }

  /* Chessboard squares */
  #game-container div.square {
    width: 100%;
    height: 100%;
  }

  /* Knight */
  .knight {
    width: 50px;
    height: 50px;
    background: url('https://upload.wikimedia.org/wikipedia/commons/2/28/Chess_nlt45.svg') no-repeat center/contain;
    position: absolute;
    transition: top 0.2s, left 0.2s;
  }

  /* Obstacles */
  .obstacle {
    width: 50px;
    height: 50px;
    position: absolute;
    background: url('https://upload.wikimedia.org/wikipedia/commons/4/45/Chess_pdt45.svg') no-repeat center/contain;
  }

  /* On-screen controls */
  #osd-controls {
    margin-top: 10px;
    display: flex;
    flex-wrap: wrap;
    width: 250px;
    justify-content: center;
    gap: 5px;
  }

  .osd-button {
    width: 60px;
    height: 60px;
    background: #fff;
    border-radius: 10px;
    color: #000;
    font-weight: bold;
    font-size: 1.2em;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    user-select: none;
    box-shadow: 2px 2px 6px #000;
    transition: 0.1s;
  }

  .osd-button:active {
    transform: scale(0.95);
  }

  #score {
    margin-top: 10px;
    font-size: 1.2em;
  }

  #game-over {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 2em;
    color: #ff4c4c;
    display: none;
    text-shadow: 2px 2px 8px #000;
  }
</style>
</head>
<body>
<h1>Knight Runner</h1>
<div id="game-container"></div>
<div id="score">Score: 0</div>
<div id="osd-controls">
  <div class="osd-button" data-dir="up-left">UL</div>
  <div class="osd-button" data-dir="up-right">UR</div>
  <div class="osd-button" data-dir="right-up">RU</div>
  <div class="osd-button" data-dir="right-down">RD</div>
  <div class="osd-button" data-dir="down-right">DR</div>
  <div class="osd-button" data-dir="down-left">DL</div>
  <div class="osd-button" data-dir="left-down">LD</div>
  <div class="osd-button" data-dir="left-up">LU</div>
</div>

<script>
const gameContainer = document.getElementById('game-container');
const scoreDisplay = document.getElementById('score');
const knight = document.createElement('div');
knight.classList.add('knight');
gameContainer.appendChild(knight);

const gameOverText = document.createElement('div');
gameOverText.id = 'game-over';
gameOverText.textContent = 'Game Over!';
gameContainer.appendChild(gameOverText);

const gridSize = 75; // Chessboard 8x8 in 600px container
let knightPos = { x: 4, y: 4 }; // center
let score = 0;
let obstacles = [];

const knightMoves = {
  "up-left": [{x:-2,y:-1},{x:-1,y:-2}],
  "up-right": [{x:2,y:-1},{x:1,y:-2}],
  "right-up": [{x:1,y:-2},{x:2,y:-1}],
  "right-down": [{x:1,y:2},{x:2,y:1}],
  "down-right": [{x:2,y:1},{x:1,y:2}],
  "down-left": [{x:-2,y:1},{x:-1,y:2}],
  "left-down": [{x:-1,y:2},{x:-2,y:1}],
  "left-up": [{x:-1,y:-2},{x:-2,y:-1}]
};

// Create chessboard squares
for(let y=0;y<8;y++){
  for(let x=0;x<8;x++){
    const square = document.createElement('div');
    square.classList.add('square');
    square.style.backgroundColor = (x+y)%2===0 ? '#f0d9b5' : '#b58863'; // light/dark
    gameContainer.appendChild(square);
  }
}

function placeKnight() {
  knight.style.left = `${knightPos.x * gridSize}px`;
  knight.style.top = `${knightPos.y * gridSize}px`;
}

function addObstacle() {
  const obstacle = document.createElement('div');
  obstacle.classList.add('obstacle');

  let pos;
  do {
    pos = {x: Math.floor(Math.random()*8), y: Math.floor(Math.random()*8)};
  } while ((pos.x === knightPos.x && pos.y === knightPos.y) || obstacles.some(o=>o.x===pos.x && o.y===pos.y));

  obstacle.style.left = `${pos.x * gridSize}px`;
  obstacle.style.top = `${pos.y * gridSize}px`;

  gameContainer.appendChild(obstacle);
  obstacles.push({el: obstacle, ...pos});
}

function checkCollision() {
  return obstacles.some(o => o.x === knightPos.x && o.y === knightPos.y);
}

function gameOver() {
  clearInterval(gameInterval);
  gameOverText.style.display = 'block';
}

function moveKnight(direction) {
  const moves = knightMoves[direction];
  if (!moves) return;

  knightPos.x += moves[0].x;
  knightPos.y += moves[0].y;
  constrainPosition();
  placeKnight();

  setTimeout(() => {
    knightPos.x += moves[1].x;
    knightPos.y += moves[1].y;
    constrainPosition();
    placeKnight();

    if (checkCollision()) gameOver();
    else {
      score++;
      scoreDisplay.textContent = `Score: ${score}`;
    }
  }, 100);
}

function constrainPosition() {
  if(knightPos.x<0) knightPos.x=0;
  if(knightPos.y<0) knightPos.y=0;
  if(knightPos.x>7) knightPos.x=7;
  if(knightPos.y>7) knightPos.y=7;
}

// Keyboard controls
document.addEventListener('keydown', e => {
  switch(e.key){
    case "ArrowUp": moveKnight("up-left"); break;
    case "ArrowDown": moveKnight("down-right"); break;
    case "ArrowLeft": moveKnight("left-up"); break;
    case "ArrowRight": moveKnight("right-down"); break;
  }
});

// On-screen buttons
document.querySelectorAll('.osd-button').forEach(btn=>{
  btn.addEventListener('click', ()=>moveKnight(btn.dataset.dir));
});

// Obstacles every 2s
let gameInterval = setInterval(()=>{
  addObstacle();
  if(checkCollision()) gameOver();
},2000);

placeKnight();
</script>
</body>
</html>
